jobs:
  - job: Backend
    pool:
      vmImage: 'vs2017-win2016'
    steps:
    - task: DotNetCoreInstaller@0
      inputs:
        version: '2.1.402'
    - script: dotnet restore
      workingDirectory: backend/mobilityAI
      displayName: 'Install Dependencies'
    - script: dotnet build
      workingDirectory: backend/mobilityAI
      displayName: 'Build'
  - job: Frontend
    pool:
      vmImage: 'vs2017-win2016'
    steps:
    - task: NodeTool@0
      inputs:
        versionSpec: '9.7.1'
      displayName: 'Install Node'
    - script: npm install
      workingDirectory: frontend/mobilityai_react
      displayName: 'Install dependencies'
    - script: npm run test-ci
      workingDirectory: frontend/mobilityai_react
      displayName: 'Run tests'
  - job: Machine_Learning
    pool:
      vmImage: 'vs2017-win2016'
    steps:
    - task: UsePythonVersion@0
      inputs:
        versionSpec: '3.6'
        architecture: 'x64'
    - script: pip install pipenv
      workingDirectory: machine_learning
      displayName: 'Install pipenv'
    - script: pipenv shell
      workingDiretory: machine_learning
      displayName: 'Enter pipenv shell'
    - script: pipenv install
      workingDiretory: machine_learning
      displayName: 'Install dependencies'
    - script: pipenv run pytest
      workingDiretory: machine_learning
      displayName: 'Run tests'
